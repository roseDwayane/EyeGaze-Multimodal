# Eye Gaze Ã— EEG èåˆæ¶æ§‹è¦–è¦ºå°æ¯” (Architecture Visual Comparison)

## ä¸‰ç¨®èåˆç­–ç•¥å®Œæ•´å°æ¯”åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     INPUT: Eye Gaze Images + EEG Signals                    â”‚
â”‚                                                                             â”‚
â”‚   img1 (P1)        img2 (P2)        eeg1 (P1)        eeg2 (P2)             â”‚
â”‚  (3,224,224)      (3,224,224)      (32,1024)        (32,1024)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                â”‚                â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  EARLY FUSION   â”‚  â”‚  MID   â”‚  â”‚  LATE FUSION   â”‚
           â”‚   (Strategy C)  â”‚  â”‚ FUSION â”‚  â”‚  (Strategy A)  â”‚
           â”‚                 â”‚  â”‚ (ä¸»è¦)  â”‚  â”‚                â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚               â”‚                â”‚
                    â”‚               â”‚                â”‚
                    â–¼               â–¼                â–¼
```

---

## Strategy A: Late Fusion (æ±ºç­–å±¤èåˆ)

### æ¶æ§‹æµç¨‹åœ–

```
è¼¸å…¥å±¤ (Input)
    img1 (3,224,224)  img2 (3,224,224)  eeg1 (32,1024)  eeg2 (32,1024)
         â”‚                  â”‚                â”‚                â”‚
         â”‚                  â”‚                â”‚                â”‚
         â–¼                  â–¼                â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Pre-trained ViT       â”‚        â”‚  Pre-trained Dual EEG   â”‚
    â”‚   (Image Encoder)       â”‚        â”‚     Transformer         â”‚
    â”‚                         â”‚        â”‚                         â”‚
    â”‚  - Patch Embedding      â”‚        â”‚  - Conv1D Embedding     â”‚
    â”‚  - 12 Transformer       â”‚        â”‚  - 6 Transformer        â”‚
    â”‚    Layers               â”‚        â”‚    Layers (Siamese)     â”‚
    â”‚  - CLS Token            â”‚        â”‚  - CLS1, CLS2, IBS      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚                â”‚                â”‚
         â”‚                  â”‚                â”‚                â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                                     â”‚
                â–¼                                     â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Average    â”‚                      â”‚  Concat &   â”‚
         â”‚  CLS tokens â”‚                      â”‚  Average    â”‚
         â”‚  (768-dim)  â”‚                      â”‚  (256-dim)  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                                     â”‚
                â”‚                                     â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Fusion Layer   â”‚
                    â”‚                 â”‚
                    â”‚  [Mode 1]       â”‚
                    â”‚  Weighted Avg   â”‚   â† logits mode
                    â”‚  of Logits      â”‚
                    â”‚                 â”‚
                    â”‚  [Mode 2]       â”‚
                    â”‚  Concat Featuresâ”‚   â† features mode
                    â”‚  â†’ MLP          â”‚      (æ¨è–¦)
                    â”‚  (768+512)â†’512  â”‚
                    â”‚  â†’256â†’3         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    Final Predictions (3 classes)
```

### ç‰¹é»
- âœ… **ç°¡å–®ç›´è§€**: å…©å€‹ç¨ç«‹æ¨¡å‹çš„çµ„åˆ
- âœ… **æ¨¡çµ„åŒ–**: å¯ä»¥éˆæ´»æ›¿æ›ä»»ä¸€æ¨¡æ…‹çš„æ¨¡å‹
- âœ… **å¯è§£é‡‹æ€§**: å¯åˆ†ææ¯å€‹æ¨¡æ…‹çš„ç¨ç«‹è²¢ç»
- âŒ **äº¤äº’æœ‰é™**: ç¼ºä¹è·¨æ¨¡æ…‹ä¿¡æ¯äº¤æ›
- âŒ **èåˆè¼ƒæ™š**: åœ¨æ±ºç­–éšæ®µæ‰èåˆ

### é—œéµåƒæ•¸
```yaml
fusion_mode: "features"      # æˆ– "logits"
freeze_image: false          # æ˜¯å¦å‡çµå½±åƒæ¨¡å‹
freeze_eeg: false            # æ˜¯å¦å‡çµ EEG æ¨¡å‹
fusion_hidden_dim: 512       # èåˆ MLP éš±è—å±¤ç¶­åº¦
```

---

## Strategy B: Mid Fusion (ä¸­é–“å±¤èåˆ) ã€ä¸»è¦è²¢ç»ã€‘

### å®Œæ•´æ¶æ§‹æµç¨‹åœ–

```
è¼¸å…¥å±¤ (Input)
    img1 (P1)     img2 (P2)     eeg1 (P1)     eeg2 (P2)
  (3,224,224)   (3,224,224)   (32,1024)     (32,1024)
       â”‚             â”‚             â”‚             â”‚
       â”‚             â”‚             â”‚             â”‚
       â–¼             â–¼             â–¼             â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ViT     â”‚  â”‚ ViT     â”‚  â”‚ EEG     â”‚  â”‚ EEG     â”‚  â† Four-Tower
  â”‚ Encoder â”‚  â”‚ Encoder â”‚  â”‚ Trans.  â”‚  â”‚ Trans.  â”‚    Architecture
  â”‚ P1      â”‚  â”‚ P2      â”‚  â”‚ P1      â”‚  â”‚ P2      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚             â”‚             â”‚             â”‚
       â”‚ (768)       â”‚ (768)       â”‚ (256)       â”‚ (256)
       â”‚             â”‚             â”‚             â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
              â”‚                           â”‚
              â–¼                           â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  Symmetric   â”‚           â”‚  Symmetric   â”‚
       â”‚  Fusion      â”‚           â”‚  Fusion      â”‚
       â”‚  (Image)     â”‚           â”‚  (EEG)       â”‚
       â”‚              â”‚           â”‚              â”‚
       â”‚  z_sum  = z1+z2          â”‚  z_sum  = z1+z2
       â”‚  z_mul  = z1*z2          â”‚  z_mul  = z1*z2
       â”‚  z_diff = |z1-z2|        â”‚  z_diff = |z1-z2|
       â”‚              â”‚           â”‚              â”‚
       â”‚  Concat â†’    â”‚           â”‚  Concat â†’    â”‚
       â”‚  Linear(2304â†’768)        â”‚  Linear(768â†’256)
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                           â”‚
              â”‚ z_img (768)               â”‚ z_eeg (256)
              â”‚                           â”‚
              â”‚                           â”‚
              â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚         â”‚                                â”‚
              â”‚         â”‚  IBS Token Generator           â”‚
              â”‚         â”‚  (Inter-Brain Synchrony)       â”‚
              â”‚         â”‚                                â”‚
              â”‚         â”‚  1. PLV (Phase Locking Value)  â”‚
              â”‚         â”‚     - Delta, Theta, Alpha,     â”‚
              â”‚         â”‚       Beta, Gamma bands        â”‚
              â”‚         â”‚  2. Power Correlation          â”‚
              â”‚         â”‚  3. Phase Difference Stats     â”‚
              â”‚         â”‚                                â”‚
              â”‚         â”‚  â†’ Concat all features         â”‚
              â”‚         â”‚  â†’ Linear(features â†’ 256)      â”‚
              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                           â”‚
              â”‚                           â”‚ z_ibs (256)
              â”‚                           â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ z_img (768), z_eeg (256), z_ibs (256)
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Cross-Modal         â”‚
              â”‚  Bidirectional       â”‚
              â”‚  Attention           â”‚
              â”‚                      â”‚
              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
              â”‚  â”‚ Img â†’ EEG   â”‚    â”‚  Image attends to EEG
              â”‚  â”‚ Q from Img  â”‚    â”‚
              â”‚  â”‚ K,V from EEGâ”‚    â”‚
              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
              â”‚         +            â”‚
              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
              â”‚  â”‚ EEG â†’ Img   â”‚    â”‚  EEG attends to Image
              â”‚  â”‚ Q from EEG  â”‚    â”‚
              â”‚  â”‚ K,V from Imgâ”‚    â”‚
              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ z_img' (768), z_eeg' (256), z_ibs' (256)
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Final Fusion        â”‚
              â”‚                      â”‚
              â”‚  Concat all features â”‚
              â”‚  [z_img', z_eeg', z_ibs']
              â”‚  (768+256+256=1280)  â”‚
              â”‚         â†“            â”‚
              â”‚  Linear(1280 â†’ 512)  â”‚
              â”‚  LayerNorm + ReLU    â”‚
              â”‚  Dropout(0.3)        â”‚
              â”‚         â†“            â”‚
              â”‚  Linear(512 â†’ 256)   â”‚
              â”‚  LayerNorm + ReLU    â”‚
              â”‚  Dropout(0.3)        â”‚
              â”‚         â†“            â”‚
              â”‚  Linear(256 â†’ 3)     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                Final Predictions (3 classes)
```

### é—œéµå‰µæ–°é»

#### 1ï¸âƒ£ Symmetric Fusion Operators
```python
# å°ç¨±æ€§ä¿è­‰: f(z1, z2) = f(z2, z1)
z_sum  = z1 + z2              # åŠ æ³•å°ç¨±
z_mul  = z1 * z2              # Hadamard ç©å°ç¨±
z_diff = |z1 - z2|            # çµ•å°å·®ç•°å°ç¨±

# æ‹¼æ¥å¾ŒæŠ•å½±
z_fused = Linear([z_sum; z_mul; z_diff])  # (3D â†’ D)
```

#### 2ï¸âƒ£ IBS Token Generator
```python
# Phase Locking Value (PLV)
for band in ['delta', 'theta', 'alpha', 'beta', 'gamma']:
    phase1 = angle(hilbert(eeg1_band))
    phase2 = angle(hilbert(eeg2_band))
    plv = |mean(exp(j * (phase1 - phase2)))|

# Power Correlation
power_corr = corr(|eeg1|Â², |eeg2|Â²)

# IBS features â†’ Linear â†’ z_ibs (256-dim)
```

#### 3ï¸âƒ£ Cross-Modal Attention
```python
# Image â†’ EEG
Q_img = W_q(z_img)
K_eeg, V_eeg = W_k(z_eeg), W_v(z_eeg)
attn_img = Softmax(Q_img @ K_eeg^T / âˆšd) @ V_eeg
z_img' = LayerNorm(z_img + attn_img)

# EEG â†’ Image (symmetric)
Q_eeg = W_q(z_eeg)
K_img, V_img = W_k(z_img), W_v(z_img)
attn_eeg = Softmax(Q_eeg @ K_img^T / âˆšd) @ V_img
z_eeg' = LayerNorm(z_eeg + attn_eeg)
```

### ç‰¹é»
- âœ… **è·¨æ¨¡æ…‹äº¤äº’**: Bidirectional attention å¯¦ç¾ä¿¡æ¯äº¤æ›
- âœ… **IBS å»ºæ¨¡**: é¡¯å¼å»ºæ¨¡è…¦é–“åŒæ­¥
- âœ… **å°ç¨±æ€§**: Symmetric fusion ç¢ºä¿æ’åˆ—ä¸è®Šæ€§
- âœ… **æœ€ä½³æ€§èƒ½**: é æœŸæº–ç¢ºç‡ 75-82%
- âŒ **è¨ˆç®—è¤‡é›œ**: åƒæ•¸é‡æœ€å¤§ (~110M)
- âŒ **è¨“ç·´æ™‚é–“é•·**: é ä¼° 5 å°æ™‚/50 epochs

### é—œéµåƒæ•¸
```yaml
use_ibs_token: true              # ä½¿ç”¨ IBS token
use_cross_attention: true        # ä½¿ç”¨è·¨æ¨¡æ…‹æ³¨æ„åŠ›
symmetric_fusion_mode: "full"    # full/basic/learnable
image_shared_weights: true       # å½±åƒç·¨ç¢¼å™¨å…±äº«æ¬Šé‡
eeg_shared_weights: true         # EEG ç·¨ç¢¼å™¨å…±äº«æ¬Šé‡
```

---

## Strategy C: Early Fusion (è¼¸å…¥å±¤èåˆ)

### æ¶æ§‹æµç¨‹åœ–

```
è¼¸å…¥å±¤ (Input)
    img1 (P1)     img2 (P2)     eeg1 (P1)     eeg2 (P2)
  (3,224,224)   (3,224,224)   (32,1024)     (32,1024)
       â”‚             â”‚             â”‚             â”‚
       â”‚             â”‚             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚             â”‚                    â”‚
       â”‚             â”‚                    â–¼
       â”‚             â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚             â”‚         â”‚  EEG â†’ Time-Freq     â”‚
       â”‚             â”‚         â”‚  Transformation      â”‚
       â”‚             â”‚         â”‚                      â”‚
       â”‚             â”‚         â”‚  1. STFT (Short-Time â”‚
       â”‚             â”‚         â”‚     Fourier Trans.)  â”‚
       â”‚             â”‚         â”‚     - n_fft: 256     â”‚
       â”‚             â”‚         â”‚     - hop: 64        â”‚
       â”‚             â”‚         â”‚                      â”‚
       â”‚             â”‚         â”‚  2. Magnitude        â”‚
       â”‚             â”‚         â”‚     spec = |STFT|    â”‚
       â”‚             â”‚         â”‚     (32, F, T)       â”‚
       â”‚             â”‚         â”‚                      â”‚
       â”‚             â”‚         â”‚  3. Average channels â”‚
       â”‚             â”‚         â”‚     spec_avg = mean  â”‚
       â”‚             â”‚         â”‚     (F, T)           â”‚
       â”‚             â”‚         â”‚                      â”‚
       â”‚             â”‚         â”‚  4. Resize to 224x224â”‚
       â”‚             â”‚         â”‚                      â”‚
       â”‚             â”‚         â”‚  5. Repeat to RGB    â”‚
       â”‚             â”‚         â”‚     (3, 224, 224)    â”‚
       â”‚             â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚             â”‚                    â”‚
       â”‚             â”‚                    â”‚
       â”‚             â”‚         eeg1_img   â”‚   eeg2_img
       â”‚             â”‚         (3,224,224) (3,224,224)
       â”‚             â”‚                    â”‚
       â”‚             â”‚                    â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                  â”‚
              â–¼                                  â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  Fusion Mode 1  â”‚            â”‚  Fusion Mode 2  â”‚
       â”‚  "average"      â”‚            â”‚  "concatenate"  â”‚
       â”‚                 â”‚            â”‚                 â”‚
       â”‚  img_avg =      â”‚            â”‚  stacked =      â”‚
       â”‚   (img1+img2)/2 â”‚            â”‚   [img1, img2,  â”‚
       â”‚  eeg_avg =      â”‚            â”‚    eeg1_img,    â”‚
       â”‚   (eeg1+eeg2)/2 â”‚            â”‚    eeg2_img]    â”‚
       â”‚                 â”‚            â”‚                 â”‚
       â”‚  fused =        â”‚            â”‚  (12, 224, 224) â”‚
       â”‚  [img_avg,      â”‚            â”‚                 â”‚
       â”‚   eeg_avg]      â”‚            â”‚  â†“ Conv1x1      â”‚
       â”‚                 â”‚            â”‚  (12â†’3 channels)â”‚
       â”‚  (6, 224, 224)  â”‚            â”‚                 â”‚
       â”‚                 â”‚            â”‚  (3, 224, 224)  â”‚
       â”‚  â†“ Conv1x1      â”‚            â”‚                 â”‚
       â”‚  (6â†’3 channels) â”‚            â”‚                 â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Vision         â”‚
                    â”‚  Transformer    â”‚
                    â”‚  (ViT)          â”‚
                    â”‚                 â”‚
                    â”‚  - Patch Embed  â”‚
                    â”‚  - 12 Layers    â”‚
                    â”‚  - CLS Token    â”‚
                    â”‚  - Classifier   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    Final Predictions (3 classes)
```

### EEG â†’ Image è½‰æ›ç´°ç¯€

```
EEG Signal (32, 1024)
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Channel 1:  [x0, x1, ..., x1023]   â”‚
â”‚  Channel 2:  [x0, x1, ..., x1023]   â”‚
â”‚  ...                                 â”‚
â”‚  Channel 32: [x0, x1, ..., x1023]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ STFT (n_fft=256, hop=64)
    â–¼
Spectrogram (32, 129, 17)
    - 32 channels
    - 129 frequency bins
    - 17 time frames
    â”‚
    â”‚ Average across channels
    â–¼
Average Spectrogram (129, 17)
    â”‚
    â”‚ Resize to (224, 224)
    â–¼
Resized Spectrogram (224, 224)
    â”‚
    â”‚ Repeat to 3 channels (pseudo-RGB)
    â–¼
Pseudo-Image (3, 224, 224)
```

### ç‰¹é»
- âœ… **çµ±ä¸€è¼¸å…¥**: æ‰€æœ‰æ¨¡æ…‹è½‰ç‚ºè¦–è¦ºè¡¨ç¤º
- âœ… **ç°¡å–®é«˜æ•ˆ**: å–®ä¸€ ViT æ¨¡å‹
- âœ… **è¨“ç·´æœ€å¿«**: é ä¼° 2 å°æ™‚/50 epochs
- âŒ **ä¿¡æ¯æå¤±**: EEG æ™‚åºä¿¡æ¯æå¤±
- âŒ **æ€§èƒ½è¼ƒä½**: é æœŸæº–ç¢ºç‡ 65-72%
- âŒ **å¯è§£é‡‹æ€§å·®**: é›£ä»¥åˆ†æå„æ¨¡æ…‹è²¢ç»

### é—œéµåƒæ•¸
```yaml
fusion_strategy: "average"    # æˆ– "concatenate"
n_fft: 256                    # STFT FFT é»æ•¸
hop_length: 64                # STFT hop size
freq_bins: 64                 # ä¿ç•™çš„é »ç‡ bins
```

---

## ä¸‰ç¨®ç­–ç•¥æ€§èƒ½å°æ¯”è¡¨

| æŒ‡æ¨™ | Early Fusion | Late Fusion | Mid Fusion â­ |
|------|-------------|-------------|--------------|
| **é æœŸæº–ç¢ºç‡** | 65-72% | 70-78% | **75-82%** |
| **é æœŸ F1** | 0.62-0.70 | 0.70-0.76 | **0.73-0.80** |
| **åƒæ•¸é‡** | ~86M | ~94M | **~110M** |
| **è¨“ç·´æ™‚é–“** | ~2h | ~3h | **~5h** |
| **æ¨è«–é€Ÿåº¦** | å¿« | ä¸­ | æ…¢ |
| **è·¨æ¨¡æ…‹äº¤äº’** | âŒ ç„¡ | âš ï¸ æœ‰é™ | âœ… **å¼·** |
| **IBS å»ºæ¨¡** | âŒ ç„¡ | âŒ ç„¡ | âœ… **æœ‰** |
| **å°ç¨±æ€§** | âš ï¸ éƒ¨åˆ† | âœ… æœ‰ | âœ… **åš´æ ¼** |
| **å¯è§£é‡‹æ€§** | ä½ | é«˜ | ä¸­ |
| **å¯¦ç¾è¤‡é›œåº¦** | ä½ | ä½ | **é«˜** |

---

## èåˆæ™‚æ©Ÿå°æ¯” (Fusion Timing Comparison)

```
Pipeline Stage:    Input â†’ Encoding â†’ Feature â†’ Decision â†’ Output

Early Fusion:      [FUSE]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Output
                    â†‘
                 èåˆç™¼ç”Ÿåœ¨æœ€æ—©

Late Fusion:       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[FUSE]â”€â”€â”€â”€â”€â”€â”€â†’ Output
                                             â†‘
                                          èåˆç™¼ç”Ÿåœ¨æœ€æ™š

Mid Fusion:        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[FUSE]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Output
                              â†‘
                           èåˆç™¼ç”Ÿåœ¨ä¸­é–“
                        (ç‰¹å¾µå±¤ + è·¨æ¨¡æ…‹äº¤äº’)
```

---

## è¨“ç·´ç­–ç•¥å»ºè­°

### 1. å¿«é€Ÿé©—è­‰ (1-2å¤©)
```bash
# å…ˆè¨“ç·´ Early Fusion ç¢ºèªè³‡æ–™å’Œæµç¨‹æ­£ç¢º
python Experiments/scripts/train_early_fusion.py --config Experiments/configs/early_fusion.yaml
```

### 2. åŸºæº–å°æ¯” (3-5å¤©)
```bash
# åŒæ™‚è¨“ç·´ä¸‰å€‹åŸºæº–æ¨¡å‹
# Terminal 1, 2, 3 ä¸¦è¡Œé‹è¡Œ
```

### 3. æ·±å…¥å„ªåŒ– (1-2é€±)
```bash
# Mid Fusion æ¶ˆèå¯¦é©— (é‡é»)
# Late Fusion æ¶ˆèå¯¦é©—
```

### 4. è«–æ–‡æ’°å¯« (2-3é€±)
- åŸºæ–¼æŠ€è¡“ç™½çš®æ›¸
- æ·»åŠ å¯¦é©—çµæœ
- å¯è¦–åŒ–åˆ†æ

---

## æ¨è–¦å¯¦é©—é †åº

**å„ªå…ˆç´š 1 (å¿…åš)**:
1. âœ… Early Fusion (average) - å¿«é€ŸåŸºæº–
2. âœ… Late Fusion (features) - ä¸­ç­‰åŸºæº–
3. âœ… Mid Fusion (full) - æœ€ä½³æ¨¡å‹

**å„ªå…ˆç´š 2 (é‡è¦)**:
4. Mid Fusion ç„¡ IBS token
5. Mid Fusion ç„¡ Cross-Attention
6. Late Fusion (logits)

**å„ªå…ˆç´š 3 (è£œå……)**:
7. Early Fusion (concatenate)
8. Mid Fusion symmetric mode variants
9. Late Fusion freeze variants

---

## é—œéµå·®ç•°ç¸½çµ

### ç‚ºä»€éº¼ Mid Fusion æœ€å¥½ï¼Ÿ

1. **IBS Token**: é¡¯å¼å»ºæ¨¡è…¦é–“åŒæ­¥ï¼Œé€™æ˜¯ä»»å‹™çš„é—œéµç‰¹å¾µ
2. **Cross-Modal Attention**: å½±åƒå’Œ EEG å¯ä»¥äº’ç›¸å¢å¼·
3. **Symmetric Fusion**: åš´æ ¼çš„æ’åˆ—ä¸è®Šæ€§ï¼Œç¬¦åˆäºŒäººäº’å‹•çš„å°ç¨±æ€§è³ª
4. **é©ç•¶èåˆæ™‚æ©Ÿ**: æ—¢ä¿ç•™æ¨¡æ…‹ç‰¹ç•°æ€§ï¼Œåˆå¯¦ç¾å……åˆ†äº¤äº’

### ç‚ºä»€éº¼ Late Fusion ä¹Ÿä¸éŒ¯ï¼Ÿ

1. **ç°¡å–®å¯é **: å…©å€‹æˆç†Ÿæ¨¡å‹çš„çµ„åˆ
2. **å¯è§£é‡‹**: å¯ä»¥åˆ†ææ¯å€‹æ¨¡æ…‹çš„ç¨ç«‹æ€§èƒ½
3. **éˆæ´»**: å¯ä»¥è¼•é¬†æ›¿æ›æˆ–æ›´æ–°å–®ä¸€æ¨¡æ…‹æ¨¡å‹

### ç‚ºä»€éº¼ Early Fusion è¼ƒå¼±ï¼Ÿ

1. **ä¿¡æ¯æå¤±**: EEG â†’ é »è­œåœ–æå¤±æ™‚åºä¿¡æ¯
2. **æ¨¡æ…‹ä¸å¹³ç­‰**: ViT ä¸»è¦ç‚ºè¦–è¦ºè¨­è¨ˆï¼ŒEEG è¢«è¿«é©æ‡‰
3. **ç¼ºä¹äº¤äº’**: åªæ˜¯ç°¡å–®çš„é€šé“æ‹¼æ¥

---

**é¸æ“‡å»ºè­°**:
- ğŸ¯ **ç ”ç©¶ç›®æ¨™**: ä½¿ç”¨ **Mid Fusion** (æœ€ä½³æ€§èƒ½ + å‰µæ–°è²¢ç»)
- ğŸ”§ **å¿«é€Ÿæ‡‰ç”¨**: ä½¿ç”¨ **Late Fusion** (å¹³è¡¡æ€§èƒ½èˆ‡è¤‡é›œåº¦)
- ğŸ“š **æ•™å­¸æ¼”ç¤º**: ä½¿ç”¨ **Early Fusion** (æ¦‚å¿µæœ€ç°¡å–®)

# Dual EEG Transformer Configuration
# Inter-Brain Synchrony Classification: Single / Competition / Cooperation

# Model Configuration
model:
  in_channels: 32              # Number of EEG channels (32 for this dataset)
  num_labels: 3                # Single, Competition, Cooperation
  d_model: 256                 # Transformer embedding dimension
  num_layers: 6                # Number of Transformer layers
  num_heads: 8                 # Number of attention heads
  d_ff: 1024                   # Feedforward dimension
  conv_kernel_size: 25         # Temporal conv kernel size
  conv_stride: 4               # Temporal conv stride (downsampling factor)
  conv_layers: 2               # Number of temporal conv layers

# Data Configuration
data:
  metadata_path: "Data/metadata/complete_metadata.json"
  eeg_base_path: "G:/共用雲端硬碟/CNElab_林佳誼_Gaze/B.GazeImage/01.data/EEGseg"  # Path to EEG CSV files
  train_test_split: 0.2        # 20% for test set
  random_seed: 42
  max_samples: null             # Limit samples for quick testing (set to null for all)

  # EEG windowing parameters
  window_size: 1024            # Number of time points per window (4 seconds at 250 Hz)
  stride: 512                  # Stride for sliding window (2 seconds overlap)
  sampling_rate: 256           # EEG sampling rate (Hz)
  filter_low: 1.0              # Low-pass filter frequency (Hz)
  filter_high: 45.0            # High-pass filter frequency (Hz)
  enable_preprocessing: false  # Enable EEG preprocessing (CAR, bandpass, z-score normalization)

  # Class mapping
  class_names: ["Single", "Competition", "Cooperation"]
  label2id:
    "Single": 0
    "Competition": 1
    "Cooperation": 2
  id2label:
    0: "Single"
    1: "Competition"
    2: "Cooperation"

# Training Configuration
training:
  output_dir: "Experiments/outputs/dual_eeg_transformer"
  num_train_epochs: 50
  per_device_train_batch_size: 128
  per_device_eval_batch_size: 128

  # Optimization
  learning_rate: 1.0e-4
  weight_decay: 0.01
  dropout: 0.1

  # Loss weights (optional losses - start with False)
  use_sym_loss: true          # Symmetry loss L_sym
  use_ibs_loss: true          # IBS alignment loss L_ibs
  lambda_sym: 0.1              # Weight for symmetry loss
  lambda_ibs: 0.1              # Weight for IBS loss

  # Saving
  save_every_n_epochs: 5       # Save checkpoint every N epochs
  metric_for_best_model: "f1"
  greater_is_better: true

  # Logging
  logging_steps: 10
  report_to: ["wandb"]         # Use wandb for logging

# System
system:
  seed: 42
  device: "cuda"               # or "cpu"
  num_workers: 4               # DataLoader workers

# Weights & Biases Configuration
wandb:
  project: "eyegaze-eeg-classification"
  run_name: "dual-eeg-transformer-baseline"
  tags:
    - "dual-eeg"
    - "transformer"
    - "ibs-token"
    - "inter-brain-synchrony"
  notes: "Dual EEG Transformer with IBS token for Single/Competition/Cooperation classification"
  entity: null                 # Set your wandb username/team here if needed

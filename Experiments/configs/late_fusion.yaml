# Late Fusion Configuration: Eye Gaze Image + EEG Signal

# Model Configuration
model:
  fusion_mode: "features"  # 'logits' or 'features'
  num_classes: 3

  # Image model (ViT)
  image_model_path: "C:/Users/user/pythonproject/EyeGaze-Multimodal/Experiments/outputs/vit_class_multiply"  # Path to pre-trained ViT checkpoint (set to null for training from scratch)
  image_size: 224
  patch_size: 16
  image_d_model: 768
  image_num_layers: 12
  image_num_heads: 12

  # EEG model (Dual EEG Transformer)
  eeg_model_path: "C:/Users/user/pythonproject/EyeGaze-Multimodal/Experiments/outputs/dual_eeg_transformer"  # Path to pre-trained EEG checkpoint
  eeg_in_channels: 32
  eeg_d_model: 256
  eeg_num_layers: 6
  eeg_num_heads: 8
  eeg_d_ff: 1024
  eeg_window_size: 1024
  eeg_conv_kernel: 25
  eeg_conv_stride: 4
  eeg_conv_layers: 2

  # Fusion
  fusion_dropout: 0.3
  fusion_hidden_dim: 512
  freeze_image: false
  freeze_eeg: false
  image_weight: 0.5
  eeg_weight: 0.5

# Data Configuration
data:
  metadata_path: "Data/metadata/complete_metadata.json"
  image_base_path: "G:/共用雲端硬碟/CNElab_林佳誼_Gaze/B.GazeImage/01.data/bgOn_heatmapOn_trajOn"
  eeg_base_path: "G:/共用雲端硬碟/CNElab_林佳誼_Gaze/B.GazeImage/01.data/EEGseg"

  train_test_split: 0.2
  random_seed: 42
  max_samples: null  # Limit samples for testing (null for all data)

  # Image settings
  image_size: 224

  # EEG settings
  eeg_window_size: 1024
  eeg_stride: 512
  enable_eeg_preprocessing: false

  # Class mapping
  class_names: ["Single", "Competition", "Cooperation"]
  label2id:
    "Single": 0
    "Competition": 1
    "Cooperation": 2
  id2label:
    0: "Single"
    1: "Competition"
    2: "Cooperation"

# Training Configuration
training:
  output_dir: "Experiments/outputs/late_fusion"
  num_train_epochs: 50
  per_device_train_batch_size: 16
  per_device_eval_batch_size: 32

  # Optimization
  learning_rate: 1.0e-4
  weight_decay: 0.01
  warmup_epochs: 5

  # Saving
  save_every_n_epochs: 5
  metric_for_best_model: "f1"
  greater_is_better: true

  # Logging
  logging_steps: 10
  report_to: ["wandb"]

# System
system:
  seed: 42
  device: "cuda"
  num_workers: 4

# Weights & Biases
wandb:
  project: "eyegaze-eeg-classification"
  run_name: "late-fusion-baseline"
  tags:
    - "late-fusion"
    - "multimodal"
    - "image+eeg"
  notes: "Late fusion of pre-trained ViT and Dual EEG Transformer"
  entity: null

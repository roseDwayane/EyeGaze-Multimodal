# ViT Configuration for Single vs Competition Classification
# Using Hugging Face Transformers

# Model Configuration
model:
  model_type: "dual"  # "single" or "dual" - dual for concatenated player1+player2
  model_name: "google/vit-base-patch16-224"
  num_labels: 3  # Single, Competition, Cooperation
  image_size: 224  # Size for each individual image
  pretrained: true
  freeze_backbone: false
  concat_mode: "horizontal"  # "horizontal" or "vertical" for dual images

# Data Configuration
data:
  metadata_path: "Data/metadata/complete_metadata.json"
  image_base_path: "Data/raw/Gaze/example"
  train_test_split: 0.02  # 2% for test set
  random_seed: 42

  # Image preprocessing
  image_size: 224
  normalize_mean: [0.485, 0.456, 0.406]  # ImageNet stats
  normalize_std: [0.229, 0.224, 0.225]

  # Class mapping
  class_names: ["Single", "Competition", "Cooperation"]
  label2id:
    "Single": 0
    "Competition": 1
    "Cooperation": 2
  id2label:
    0: "Single"
    1: "Competition"
    2: "Cooperation"

# Training Configuration (Following Hugging Face Trainer)
training:
  output_dir: "Experiments/outputs/vit_dual_classification"
  num_train_epochs: 10
  per_device_train_batch_size: 8
  per_device_eval_batch_size: 8

  # Optimization
  learning_rate: 2.0e-5
  weight_decay: 0.01
  warmup_ratio: 0.1

  # Learning rate scheduler
  lr_scheduler_type: "cosine"

  # Evaluation and Saving
  evaluation_strategy: "epoch"
  save_strategy: "epoch"
  save_total_limit: 3
  load_best_model_at_end: true
  metric_for_best_model: "f1"
  greater_is_better: true

  # Logging
  logging_dir: "Experiments/outputs/vit_dual_classification/logs"
  logging_strategy: "steps"
  logging_steps: 10
  report_to: ["tensorboard"]

  # Training optimizations
  fp16: false  # Set to true if GPU supports it
  dataloader_num_workers: 4
  remove_unused_columns: false

  # Early stopping
  early_stopping_patience: 3
  early_stopping_threshold: 0.001

# Data Augmentation (during training)
augmentation:
  enabled: true
  random_horizontal_flip: 0.5
  random_rotation: 15
  color_jitter:
    brightness: 0.2
    contrast: 0.2
    saturation: 0.2
    hue: 0.1

# Evaluation Metrics
metrics:
  - "accuracy"
  - "precision"
  - "recall"
  - "f1"
  - "confusion_matrix"

# Inference Configuration
inference:
  batch_size: 16
  device: "cuda"  # or "cpu"

# Paths
paths:
  checkpoint_dir: "Experiments/outputs/vit_dual_classification/checkpoints"
  results_dir: "Experiments/outputs/vit_dual_classification/results"

# System
system:
  seed: 42
  device: "cuda"  # or "cpu"
  num_workers: 4
